# GopiAI - Reasoning Agent

## Обзор

Reasoning Agent - это специализированный агент GopiAI, интегрирующий возможности Serena и Sequential Thinking для системного анализа задач и выполнения действий. Ключевая особенность агента - обязательное создание плана действий и получение одобрения перед выполнением потенциально опасных операций.

## Принцип работы

Агент работает по трехэтапной схеме:

1. **План** - Анализ задачи и создание детального плана действий
2. **Разрешение** - Получение одобрения пользователя на выполнение плана
3. **Выполнение** - Реализация одобренного плана

## Требования

- Python 3.9+
- MCP Server с установленными модулями:
  - Serena
  - Sequential Thinking

## Запуск

```bash
python run_mcp.py --agent-type reasoning --interactive
```

Параметры запуска:
- `--agent-type reasoning` - Выбор типа агента (по умолчанию: reasoning)
- `--interactive` или `-i` - Запуск в интерактивном режиме
- `--connection` или `-c` - Тип подключения к MCP: stdio или sse (по умолчанию: stdio)
- `--server-url` - URL сервера MCP для подключения по SSE (по умолчанию: http://127.0.0.1:8000/sse)

## Команды в интерактивном режиме

- `plan <задача>` - Создать план для указанной задачи
- `approve` - Одобрить предложенный план и разрешить выполнение
- `reject` - Отклонить план и запросить новый
- `exit` или `quit` - Завершить работу

## Структура плана

План включает следующие разделы:

1. **Задача** - Описание поставленной задачи
2. **Шаги выполнения** - Последовательность действий с обоснованием
3. **Риски и их смягчение** - Потенциальные проблемы и способы их предотвращения
4. **Необходимые инструменты** - Список инструментов, требуемых для выполнения

## Ограничения

До одобрения плана агент не может использовать следующие инструменты:
- Выполнение команд в терминале
- Редактирование и удаление файлов
- Выполнение shell-команд через Serena
- Создание новых файлов
- Замена и вставка строк в файлах

## Пример использования

```
Запуск:
> python run_mcp.py --agent-type reasoning --interactive

GopiAI Reasoning Agent Interactive Mode (type 'exit' to quit)

Введите запрос: plan Создать файл hello.py, который выводит приветствие

Предлагаемый план:

# План выполнения задачи

## Задача
Создать файл hello.py, который выводит приветствие

## Шаги выполнения

### Анализ задачи
Задача требует создания нового Python-файла с простым кодом для вывода приветствия.

### Шаг 1
Определить содержимое файла hello.py, включая приветственное сообщение.

### Шаг 2
Создать файл hello.py с помощью инструмента edit_file.

### Заключение
Файл hello.py успешно создан и готов к использованию.

## Риски и их смягчение
- Потенциальные конфликты с существующим кодом - будет произведено тестирование
- Потеря данных - резервное копирование перед изменениями
- Проблемы с производительностью - профилирование после внедрения

## Необходимые инструменты
- edit_file
- run_terminal_cmd

Ответьте 'approve' для принятия плана или 'reject' для отклонения.

Введите запрос: approve

План одобрен. Приступаю к выполнению.

Введите запрос: Создай простой файл hello.py с приветствием

Agent: Создаю файл hello.py с простым приветствием...

Файл hello.py успешно создан со следующим содержимым:

```python
#!/usr/bin/env python
"""
Простой скрипт с приветствием
"""

def main():
    """Основная функция, выводящая приветствие"""
    print("Привет, мир! Это GopiAI Reasoning Agent!")

if __name__ == "__main__":
    main()
```

Вы можете запустить его командой `python hello.py`
```

## Расширенные возможности

### Sequential Thinking

Агент использует Sequential Thinking для пошагового анализа задач:

1. **Последовательный анализ** - Разбиение сложной задачи на простые шаги
2. **Пересмотр мыслей** - Возможность вернуться и пересмотреть предыдущие рассуждения
3. **Ветвление логики** - Рассмотрение альтернативных путей решения

### Serena

Интеграция с Serena предоставляет:

1. **Доступ к файловой системе** - Работа с файлами и директориями
2. **Выполнение команд** - Безопасное выполнение shell-команд
3. **Системные инструменты** - Широкий набор инструментов для разработки
