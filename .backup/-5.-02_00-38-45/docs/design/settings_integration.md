# Интеграция и развитие системы настроек GopiAI

## Назначение
Этот документ описывает архитектуру, UI и процесс работы с системой настроек в GopiAI, а также рекомендации по расширению и поддержке.

---

## 1. Архитектура
- Все настройки приложения хранятся в файле `config/config.toml`.
- Для доступа к настройкам используется синглтон `Config` из `app/config.py`.
- Настройки разделены на секции: LLM, Browser, Proxy и др.
- Для валидации и типизации используется Pydantic.

## 2. UI (SettingsWidget)
- Виджет настроек реализован в `app/ui/settings_widget.py`.
- Все поля снабжены подсказками (tooltips) и поддерживают интернационализацию.
- Поддерживаются секции:
  - LLM: model, api_key, temperature, max_tokens
  - Browser: headless, disable_security, chrome_instance_path
  - Proxy: server, username, password
- Все сообщения и подписи используют систему переводов (через self.tr).
- Валидация всех полей: обязательные, диапазоны, типы.
- Ошибки и успехи отображаются дружелюбно и понятно.

## 3. Сценарии использования
- Открытие настроек через меню ("Настройки"/"Preferences...").
- Редактирование и сохранение параметров.
- Проверка и обработка ошибок (например, пустые поля, неверные значения).
- После сохранения — уведомление об успехе.

## 4. Рекомендации по расширению
- Для добавления новых настроек: добавить поле в config.toml, расширить модель в config.py, добавить поле в SettingsWidget.
- Для новых языков: добавить ключи в en.json/ru.json, использовать self.tr для всех новых строк.
- Для новых секций: следовать существующей архитектуре (разделение по секциям, валидация, tooltips).

## 5. Тестирование
- Проверять работу настроек вручную после изменений.
- Добавлять автоматические тесты для новых функций.

## 6. Возможные проблемы
- Некорректные значения в config.toml могут привести к ошибкам загрузки — все ошибки должны обрабатываться мягко.
- При изменении структуры настроек — обновлять документацию и UI.

---

Документ поддерживается и обновляется по мере развития системы настроек.