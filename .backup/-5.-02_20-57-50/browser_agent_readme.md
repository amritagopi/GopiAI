# GopiAI Browser Integration

## Обзор
Модуль интеграции с браузером в GopiAI предоставляет возможность управления веб-браузером с использованием системы разрешений и планирования действий агента. Он обеспечивает безопасное взаимодействие с веб-страницами через reasoning agent, позволяя автоматизировать работу с веб-сайтами, извлекать информацию, а также заполнять формы и другие взаимодействия.

## Архитектура

### Основные компоненты
- **BrowserAccess**: Базовый класс для контролируемого доступа к браузеру.
- **BrowserAccessAgent**: Расширение ReasoningAgent для работы с браузером.
- **Менеджер разрешений**: Система для проверки и одобрения действий в браузере.
- **Браузерные инструменты**: Набор инструментов для управления, анализа и создания скриншотов.

### Схема работы
1. Пользователь задает задачу для выполнения с использованием браузера
2. Agent создает план действий с пояснениями и оценкой рисков
3. Пользователь изучает план и решает его одобрить или отклонить
4. После одобрения плана агент последовательно выполняет шаги
5. На каждом шаге происходит проверка безопасности действий
6. Результаты выполнения плана предоставляются пользователю

## Функциональные возможности

### Базовые действия
- Навигация по URL
- Клики по элементам страницы
- Ввод текста в поля форм
- Извлечение контента страницы
- Анализ структуры страницы
- Создание скриншотов
- Управление вкладками

### Продвинутые возможности
- Создание планов с учетом текущего состояния браузера
- Оценка рисков каждого действия
- Автоматическая блокировка потенциально опасных операций
- История действий в браузере с результатами
- Механизм восстановления после ошибок

## Безопасность

### Механизмы защиты
- Проверка безопасности URL перед навигацией
- Блокировка выполнения опасного JavaScript
- Системы разрешений для всех действий
- Санитизация пользовательского ввода
- Предупреждения о потенциально опасных операциях

### Уровни риска действий
- **Низкий риск**: Чтение содержимого страницы, скриншот, получение структуры
- **Средний риск**: Навигация по проверенным URL, клики по стандартным элементам интерфейса
- **Высокий риск**: Ввод информации в формы, отправка данных
- **Критический риск**: Выполнение JavaScript, файловые операции в браузере, доступ к локальным данным

## Примеры использования

### Поиск информации
```python
# Создание плана для поиска
search_task = "Найти информацию о GopiAI на GitHub"
plan = await browser_agent.prepare_browser_plan(search_task)

# Выполнение после одобрения
result = await browser_agent.execute_browser_plan()
```

### Заполнение формы
```python
# Прямой доступ к браузерным методам
await browser_agent.navigate_to_url("https://example.com/form")
await browser_agent.input_text("#username", "user123")
await browser_agent.input_text("#password", "secure_password")
await browser_agent.click_element("#submit-button")
```

### Извлечение данных
```python
# Получение информации со страницы
content = await browser_agent.extract_content(".main-content")
structure = await browser_agent.get_page_structure()
```

## Запуск демонстрации

Для запуска демонстрационного приложения используйте:

```
python browser_agent_demo.py
```

Демонстрация позволяет:
1. Выполнить поиск по запросу
2. Заполнить демо-форму на httpbin.org
3. Создать скриншот выбранного веб-сайта

## Интеграция в проект

### Включение в свой код
```python
from app.agent.browser_access_agent import BrowserAccessAgent

# Создание агента
browser_agent = BrowserAccessAgent()
await browser_agent.initialize()

# Использование
task = "Найти и извлечь данные с web-страницы"
plan = await browser_agent.prepare_browser_plan(task)

# Получение одобрения через UI или программно
browser_agent.approve_plan()

# Выполнение плана
result = await browser_agent.execute_browser_plan()
```

## Тестирование

Для запуска тестов браузерного агента используйте:

```
python tests/test_browser_access_agent.py
```

## Ограничения
- Текущая версия не поддерживает работу с CAPTCHA
- Не все веб-сайты корректно обрабатываются (особенно с динамической загрузкой через JavaScript)
- Требуется установленный веб-браузер (Chrome/Chromium) и драйвер WebDriver

## Планы развития
- Добавление поддержки аутентификации
- Улучшение обработки JavaScript-интенсивных сайтов
- Расширение возможностей взаимодействия с формами
- Добавление поддержки распознавания CAPTCHA
- Интеграция с системой плагинов
